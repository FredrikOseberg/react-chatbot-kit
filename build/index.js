module.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-conditionally-render")},function(e,t,r){"use strict";r.r(t),r.d(t,"Chatbot",(function(){return B})),r.d(t,"createChatBotMessage",(function(){return l})),r.d(t,"createClientMessage",(function(){return m})),r.d(t,"createCustomMessage",(function(){return u})),r.d(t,"useChatbot",(function(){return A}));var a=r(0),n=r.n(a),o=r(1),s=r.n(o),c=function(){return(c=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},i=function(e,t){return{message:e,type:t,id:Math.round(Date.now()*Math.random())}},l=function(e,t){return c(c(c({},i(e,"bot")),t),{loading:!0})},u=function(e,t,r){return c(c({},i(e,t)),r)},m=function(e,t){return c(c({},i(e,"user")),t)},f=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e)return e.apply(void 0,t)};function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var d=({styles:e={},...t})=>n.a.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),n.a.createElement("path",{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"})),p=function(e){var t=e.message,r=e.customComponents;return n.a.createElement("div",{className:"react-chatbot-kit-user-chat-message-container"},n.a.createElement(s.a,{condition:!!r.userChatMessage,show:f(r.userChatMessage,{message:t}),elseShow:n.a.createElement("div",{className:"react-chatbot-kit-user-chat-message"},t,n.a.createElement("div",{className:"react-chatbot-kit-user-chat-message-arrow"}))}),n.a.createElement(s.a,{condition:!!r.userAvatar,show:f(r.userAvatar),elseShow:n.a.createElement("div",{className:"react-chatbot-kit-user-avatar"},n.a.createElement("div",{className:"react-chatbot-kit-user-avatar-container"},n.a.createElement(d,{className:"react-chatbot-kit-user-avatar-icon"})))}))},h=function(){return n.a.createElement("div",{className:"react-chatbot-kit-chat-bot-avatar"},n.a.createElement("div",{className:"react-chatbot-kit-chat-bot-avatar-container"},n.a.createElement("p",{className:"react-chatbot-kit-chat-bot-avatar-letter"},"B")))},v=function(){return n.a.createElement("div",{className:"chatbot-loader-container"},n.a.createElement("svg",{id:"dots",width:"50px",height:"21px",viewBox:"0 0 132 58",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("g",{stroke:"none",fill:"none"},n.a.createElement("g",{id:"chatbot-loader",fill:"#fff"},n.a.createElement("circle",{id:"chatbot-loader-dot1",cx:"25",cy:"30",r:"13"}),n.a.createElement("circle",{id:"chatbot-loader-dot2",cx:"65",cy:"30",r:"13"}),n.a.createElement("circle",{id:"chatbot-loader-dot3",cx:"105",cy:"30",r:"13"})))))},b=function(){return(b=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},y=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},w=function(e){var t=e.message,r=e.withAvatar,o=void 0===r||r,c=e.loading,i=e.messages,l=e.customComponents,u=e.setState,m=e.customStyles,g=e.delay,d=e.id,p=Object(a.useState)(!1),w=p[0],E=p[1];Object(a.useEffect)((function(){!function(e,t){var r=750;g&&(r+=g),setTimeout((function(){var r=y([],e,!0).find((function(e){return e.id===d}));r&&(r.loading=!1,r.delay=void 0,t((function(e){var t=e.messages,a=t.findIndex((function(e){return e.id===d}));return t[a]=r,b(b({},e),{messages:t})})))}),r)}(i,u)}),[g,d]),Object(a.useEffect)((function(){g?setTimeout((function(){return E(!0)}),g):E(!0)}),[g]);var O={backgroundColor:""},P={borderRightColor:""};return m&&(O.backgroundColor=m.backgroundColor,P.borderRightColor=m.backgroundColor),n.a.createElement(s.a,{condition:w,show:n.a.createElement("div",{className:"react-chatbot-kit-chat-bot-message-container"},n.a.createElement(s.a,{condition:o,show:n.a.createElement(s.a,{condition:!!l.botAvatar,show:f(l.botAvatar),elseShow:n.a.createElement(h,null)})}),n.a.createElement(s.a,{condition:!!l.botChatMessage,show:f(l.botChatMessage,{message:t,loader:n.a.createElement(v,null)}),elseShow:n.a.createElement("div",{className:"react-chatbot-kit-chat-bot-message",style:O},n.a.createElement(s.a,{condition:c,show:n.a.createElement(v,null),elseShow:n.a.createElement("span",null,t)}),n.a.createElement(s.a,{condition:o,show:n.a.createElement("div",{className:"react-chatbot-kit-chat-bot-message-arrow",style:P})}))}))})};function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var O=({styles:e={},...t})=>n.a.createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),n.a.createElement("path",{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"})),P=function(){return(P=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},S=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},j=function(e){var t=e.state,r=e.setState,o=e.widgetRegistry,c=e.messageParser,l=e.customComponents,u=e.actionProvider,m=e.botName,f=e.customStyles,g=e.headerText,d=e.customMessages,h=e.placeholderText,v=e.validator,b=t.messages,y=Object(a.useRef)(null),E=Object(a.useState)(""),j=E[0],k=E[1],x=function(){setTimeout((function(){y.current&&(y.current.scrollTop=y.current.scrollHeight)}),50)};Object(a.useEffect)((function(){x()}));var N=function(e){var a=d[e.type],s={setState:r,state:t,scrollIntoView:x,actionProvider:u};return e.widget?n.a.createElement(n.a.Fragment,null,a(s),o.getWidget(e.widget,P(P({},t),{scrollIntoView:x}))):a(s)},C=function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(p,{message:e.message,key:e.id,customComponents:l}),o.getWidget(e.widget,P(P({},t),{scrollIntoView:x})))},M=function(e,a){var c;c=e.withAvatar?e.withAvatar:function(e,t){if(0===t)return!0;var r=e[t-1];return!("bot"===r.type&&!r.widget)}(b,a);var i=P(P({},e),{setState:r,state:t,customComponents:l,widgetRegistry:o,messages:b});return e.widget?n.a.createElement(n.a.Fragment,null,n.a.createElement(w,P({customStyles:f.botMessageBox,withAvatar:c},i,{key:e.id})),n.a.createElement(s.a,{condition:!i.loading,show:o.getWidget(i.widget,P(P({},t),{scrollIntoView:x}))})):n.a.createElement(w,P({customStyles:f.botMessageBox,key:e.id,withAvatar:c},i,{customComponents:l,messages:b,setState:r}))},T=function(){r((function(e){return P(P({},e),{messages:S(S([],e.messages,!0),[i(j,"user")],!1)})})),x(),k("")},A={backgroundColor:""};f&&f.chatButton&&(A.backgroundColor=f.chatButton.backgroundColor);var I="Conversation with "+m;g&&(I=g);var R="Write your message here";return h&&(R=h),n.a.createElement("div",{className:"react-chatbot-kit-chat-container"},n.a.createElement("div",{className:"react-chatbot-kit-chat-inner-container"},n.a.createElement(s.a,{condition:!!l.header,show:l.header&&l.header(u),elseShow:n.a.createElement("div",{className:"react-chatbot-kit-chat-header"},I)}),n.a.createElement("div",{className:"react-chatbot-kit-chat-message-container",ref:y},b.map((function(e,t){return"bot"===e.type?M(e,t):function(e){return"user"===e.type}(e)?C(e):function(e,t){return!!t[e.type]}(e,d)?N(e):void 0})),n.a.createElement("div",{style:{paddingBottom:"15px"}})),n.a.createElement("div",{className:"react-chatbot-kit-chat-input-container"},n.a.createElement("form",{className:"react-chatbot-kit-chat-input-form",onSubmit:function(e){e.preventDefault(),v&&"function"==typeof v?v(j)&&(T(),c.parse(j)):(T(),c.parse(j))}},n.a.createElement("input",{className:"react-chatbot-kit-chat-input",placeholder:R,value:j,onChange:function(e){return k(e.target.value)}}),n.a.createElement("button",{className:"react-chatbot-kit-chat-btn-send",style:A},n.a.createElement(O,{className:"react-chatbot-kit-chat-btn-send-icon"}))))))},k=function(e){var t=e.message;return n.a.createElement("div",{className:"react-chatbot-kit-error"},n.a.createElement("h1",{className:"react-chatbot-kit-error-header"},"Ooops. Something is missing."),n.a.createElement("div",{className:"react-chatbot-kit-error-container"},n.a.createElement(w,{message:t,withAvatar:!0,loading:!1,id:1,customStyles:{backgroundColor:""},messages:[]})),n.a.createElement("a",{href:"https://fredrikoseberg.github.io/react-chatbot-kit-docs/",rel:"noopener norefferer",target:"_blank",className:"react-chatbot-kit-error-docs"},"View the docs"))},x=function(){return(x=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},N=function(e,t){var r=this;this.addWidget=function(e,t){var a=e.widgetName,n=e.widgetFunc,o=e.mapStateToProps,s=e.props;r[a]={widget:n,props:s,mapStateToProps:o,parentProps:x({},t)}},this.getWidget=function(e,t){var a=r[e];if(a){var n,o=x(x(x(x({scrollIntoView:t.scrollIntoView},a.parentProps),"object"==typeof(n=a.props)?n:{}),r.mapStateToProps(a.mapStateToProps,t)),{setState:r.setState,actionProvider:r.actionProvider});return a.widget(o)}},this.mapStateToProps=function(e,t){if(e)return e.reduce((function(e,r){return e[r]=t[r],e}),{})},this.setState=e,this.actionProvider=t},C=function(){return(C=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},M=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r},T=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},A=function(e){var t=e.config,r=e.actionProvider,o=e.messageParser,s=e.messageHistory,c=e.saveMessages,i=M(e,["config","actionProvider","messageParser","messageHistory","saveMessages"]),f="",g="";if(!t||!r||!o)return{configurationError:f="I think you forgot to feed me some props. Did you remember to pass a config, a messageparser and an actionprovider?"};var d=function(e,t){var r=[];return e.initialMessages||r.push("Config must contain property 'initialMessages', and it expects it to be an array of chatbotmessages."),(new t).parse||r.push("Messageparser must implement the method 'parse', please add this method to your object. The signature is parse(message: string)."),r}(t,o);if(d.length)return{invalidPropsError:g=d.reduce((function(e,t){return e+=t}),"")};var p=function(e){return e.state?e.state:{}}(t);s&&Array.isArray(s)&&(t.initialMessages=T([],s,!0)),console.log("GETTING HERE");var h=n.a.useState(C({messages:T([],t.initialMessages,!0)},p)),v=h[0],b=h[1],y=n.a.useRef(v.messages),w=n.a.useRef();console.log("TRYINGN TO USE STATE"),Object(a.useEffect)((function(){y.current=v.messages})),Object(a.useEffect)((function(){return s&&Array.isArray(s)&&b((function(e){return C(C({},e),{messages:s})})),function(){c&&"function"==typeof c&&c(y.current)}}),[]),Object(a.useEffect)((function(){w.current=v}),[v]);var E=new r(l,b,m,w.current,u,i),O=new N(b,E),P=new o(E,w.current);return function(e){return e.widgets?e.widgets:[]}(t).forEach((function(e){return O.addWidget(e,i)})),{widgetRegistry:O,actionProv:E,messagePars:P,configurationError:f,invalidPropsError:g,state:v,setState:b}},I=function(){return(I=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},R=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r},B=function(e){var t=e.actionProvider,r=e.messageParser,a=e.config,o=e.headerText,s=e.placeholderText,c=e.saveMessages,i=e.messageHistory,l=e.validator,u=R(e,["actionProvider","messageParser","config","headerText","placeholderText","saveMessages","messageHistory","validator"]),m=A(I({config:a,actionProvider:t,messageParser:r,messageHistory:i,saveMessages:c},u)),f=m.configurationError,g=m.invalidPropsError,d=m.actionProv,p=m.messagePars,h=m.widgetRegistry,v=m.state,b=m.setState;if(f)return n.a.createElement(k,{message:f});if(g.length)return n.a.createElement(k,{message:g});var y=function(e){return e.customStyles?e.customStyles:{}}(a),w=function(e){return e.customComponents?e.customComponents:{}}(a),E=function(e){return e.botName?e.botName:"Bot"}(a),O=function(e){return e.customMessages?e.customMessages:{}}(a);return n.a.createElement(j,{state:v,setState:b,widgetRegistry:h,actionProvider:d,messageParser:p,customMessages:O,customComponents:I({},w),botName:E,customStyles:I({},y),headerText:o,placeholderText:s,validator:l})};t.default=B}]);